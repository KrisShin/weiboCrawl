; (function ($) {

    // 左侧滚动条
    $('.lyear-header-container').niceScroll();

    // 导航切换
    $('body').on('click', '.lyear-hamburger', function () {
        $(this).toggleClass("is-active");
    });

    // 评论留言
    $('.reply-btn').on('click', function () {
        var parentLi = $(this).parents('li').first(),
            parentID = $(this).data('id'),
            respond = $('#respond'),
            respondHtml = respond.prop("outerHTML");

        $("#respond").remove();
        parentLi.after(respondHtml);
        $("#comment_parent").val(parentID);
        $('.cancel-comment-reply').show();
    });
})(jQuery);

function cancelReply() {
    var respond = $('#respond'),
        respondHtml = respond.prop("outerHTML");

    respond.remove();
    $('.lyear-comment').after(respondHtml);
    $("#comment_parent").val('0');
    $('.cancel-comment-reply').hide();
}

var keyString = ''

function updateCrawl() {
    alert("数据已请求更新， 需要耗时3-5分钟， 请稍候刷新页面即可查看最新数据");
    // $.get("/api/update_crawl_data", { name: "John", time: "2pm" });
    $.get("/api/update_crawl_data");
}

function changeKeyString(val) {
    keyString = val
}

function searchKeyWords() {
    window.location.href = '/search?search_str=' + keyString
}

function searchNoKeyWords() {
    window.location.href = '/search?search_str=' + keyString + "&exclude=true"
}

function onClickLogin() {
    var data = $('#loginform').serialize()
    $.post('/', data, function (resp) {
        if (resp.code !== 200) {
            alert(resp.error)
        }
        window.location.href = '/home'
    })
}

function onClickRegister() {
    var data = $('#registerform').serialize()
    $.post('/register', data, function (resp) {
        if (resp.code !== 200) {
            alert(resp.error)
        }
        window.location.href = '/'
    })
}

function onClickAllowLogin(user_id) {
    $.post('/allow_login', { user_id: user_id }, function (resp) {
        if (resp.code !== 200) {
            alert(resp.error)
        }
        window.location.href = '/user_list'
    })
}

